{% extends "base.html" %}

{% block title %}手工添加{{ '材料' if item_type == 'material' else '配件' if item_type == 'part' else '人工' if item_type == 'labor' else '物流' }} - 核价系统{% endblock %}

{% block content %}
<div class="mb-6">
    <a href="{{ url_for('project.detail', project_id=project.id) }}" class="text-blue-600 hover:text-blue-800 flex items-center">
        <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
        </svg>
        返回项目详情
    </a>
    <h1 class="mt-4 text-3xl font-bold text-gray-900">手工添加{{ '材料' if item_type == 'material' else '配件' if item_type == 'part' else '人工' if item_type == 'labor' else '物流' }}成本项</h1>
    <p class="mt-2 text-sm text-gray-600">项目: {{ project.raw_name }}</p>
</div>

<div class="bg-white rounded-lg shadow p-6 max-w-4xl">
    <form method="POST" action="{{ url_for('file.add_manual_item', project_id=project.id, item_type=item_type) }}" class="space-y-6">
        {% if item_type == 'material' %}
        <!-- 材料成本项表单 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1">材料名称 <span class="text-red-500">*</span></label>
                <input type="text" name="raw_name" required
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="请输入材料名称">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">规格型号</label>
                <input type="text" name="spec"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="如：50x50x5">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">材质</label>
                <input type="text" name="material_grade"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="如：Q235">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">数量</label>
                <input type="number" step="0.01" name="quantity"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">单位</label>
                <input type="text" name="unit"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="如：根、条、张">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">参考重量(kg)</label>
                <input type="number" step="0.01" name="weight_kg"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">单价</label>
                <input type="number" step="0.01" name="unit_price"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">小计</label>
                <input type="number" step="0.01" name="subtotal"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1">供应商</label>
                <input type="text" name="supplier"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="供应商名称">
            </div>
        </div>

        {% elif item_type == 'part' %}
        <!-- 配件成本项表单 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1">配件名称 <span class="text-red-500">*</span></label>
                <input type="text" name="raw_name" required
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="请输入配件名称">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">规格型号</label>
                <input type="text" name="spec"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="如：M12x50">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">供应商</label>
                <input type="text" name="supplier"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="供应商名称">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">数量</label>
                <input type="number" step="0.01" name="quantity"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">单位</label>
                <input type="text" name="unit"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="如：个、套">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">单价</label>
                <input type="number" step="0.01" name="unit_price"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">小计</label>
                <input type="number" step="0.01" name="subtotal"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
        </div>

        {% elif item_type == 'labor' %}
        <!-- 人工成本项表单 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1">班组（外协单位） <span class="text-red-500">*</span></label>
                <input type="text" name="raw_group" required
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="请输入班组名称">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">数量</label>
                <input type="number" step="0.01" name="work_quantity"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">单位</label>
                <input type="text" name="unit"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="如：吨、kg、米">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">单价</label>
                <input type="number" step="0.01" name="unit_price"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">额外补贴</label>
                <input type="number" step="0.01" name="extra_subsidies"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">吨位奖金</label>
                <input type="number" step="0.01" name="ton_bonus"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">小计</label>
                <input type="number" step="0.01" name="subtotal"
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
        </div>

        {% elif item_type == 'logistics' %}
        <!-- 物流成本项表单 -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">
                    物流类型 <span class="text-red-500">*</span>
                </label>
                <select name="type" required
                        class="w-full px-3 py-2 border border-gray-300 rounded-md
                            focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <option value="">请选择物流类型</option>
                    <option value="运输">运输费</option>
                    <option value="安装">安装费</option>
                    <option value="其他">其他</option>
                </select>
            </div>
            <div class="md:col-span-2">
                <label class="block text-sm font-medium text-gray-700 mb-1">备注描述 <span class="text-red-500">*</span></label>
                <textarea name="description" rows="3" required
                          class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                          placeholder="请输入物流成本描述，如：运输费、安装费等"></textarea>
            </div>
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-1">小计 <span class="text-red-500">*</span></label>
                <input type="number" step="0.01" name="subtotal" required
                       class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="0.00">
            </div>
        </div>
        {% endif %}

        <div class="flex justify-end space-x-4 pt-4 border-t border-gray-200">
            <a href="{{ url_for('project.detail', project_id=project.id) }}" 
               class="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50">
                取消
            </a>
            <button type="submit" 
                    class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                添加
            </button>
        </div>
    </form>
</div>
{% endblock %}

